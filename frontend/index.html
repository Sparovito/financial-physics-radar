<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Physics Terminal</title>
    <link rel="stylesheet" href="style.css?v=4">
    <!-- Plotly.js (CDN or local if downloaded) -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <!-- Sidebar Controls -->
    <div class="sidebar">
        <div class="logo">
            <span>‚ö°</span> Financial Physics
        </div>

        <div class="control-group">
            <label>Ticker</label>
            <div class="input-with-btn">
                <input type="text" id="ticker" value="SPY" placeholder="e.g. BTC-USD">
                <button id="btn-open-modal" title="Cerca Titolo">üîç</button>
            </div>
            <small>Simbolo Yahoo Finance</small>
        </div>

        <div class="control-group">
            <label>Inerzia (Alpha)</label>
            <input type="number" id="alpha" value="200" step="10">
            <small>Resistenza al movimento (Massa)</small>
        </div>

        <div class="control-group">
            <label>Fedelt√† (Beta)</label>
            <input type="number" id="beta" value="1.0" step="0.1">
            <small>Attrazione verso i Fondamentali</small>
        </div>

        <div class="control-group">
            <label>Orizzonte Previsione</label>
            <input type="number" id="forecast" value="60" step="10">
            <small>Giorni di proiezione futura</small>
        </div>

        <button class="btn-analyze" onclick="runAnalysis()">
            ANALIZZA
        </button>

        <button class="btn-radar" onclick="openRadar()"
            style="margin-top:10px; background:#2d3342; border:1px solid #eba834; color:#eba834; width:100%; padding:10px; border-radius:6px; cursor:pointer; font-weight:bold;">
            üì° MARKET RADAR
        </button>

        <div id="fourier-stats" style="margin-top: 20px; font-size: 0.8rem; color: #888;">
            <!-- Tabella cicli verr√† inserita qui -->
        </div>
    </div>

    <!-- Main Charts Area -->
    <div class="main-content">
        <div class="chart-container" style="position: relative;">
            <button onclick="toggleFullScreen('chart-combined')" class="btn-fullscreen" title="Full Screen">‚õ∂</button>
            <div id="chart-combined" style="height:100%; width:100%;"></div>
        </div>
    </div>

    <!-- Status Toast -->
    <div class="status-bar" id="status-bar">
        <div class="spinner"></div>
        <span id="status-text">Elaborazione in corso...</span>
    </div>

    <!-- TICKER SELECTION MODAL -->
    <div id="ticker-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Seleziona Asset</h3>
                <span class="close-modal">&times;</span>
            </div>

            <div class="modal-search">
                <input type="text" id="modal-search-input" placeholder="Cerca nome o simbolo (es. Apple, BTC)...">
            </div>

            <div class="modal-body">
                <div class="categories-list" id="categories-list">
                    <!-- JS Injects Categories Here -->
                </div>
                <div class="tickers-grid" id="tickers-grid">
                    <!-- JS Injects Tickers Here -->
                </div>
            </div>
        </div>
    </div>

    <!-- RADAR MODAL -->
    <div id="radar-modal" class="modal">
        <div class="modal-content" style="width: 90%; height: 90vh; max-width: 1200px;">
            <div class="modal-header">
                <h3>üì° Market Radar (Z-Score Energetici)</h3>
                <span class="close-modal" onclick="closeRadar()">&times;</span>
            </div>
            <div class="radar-controls">
                <div class="radar-inputs">
                    <select id="radar-category" class="radar-select">
                        <option value="ALL">Tutto il Mercato</option>
                        <option value="Tech">US Tech</option>
                        <option value="Crypto">Crypto</option>
                        <option value="Europe">Europa</option>
                    </select>
                    <button onclick="runRadarScan()" class="btn-scan">
                        SCANSIONA
                    </button>
                </div>

                <!-- TIMELINE CONTROLS -->
                <div class="timeline-group">
                    <label class="label-timeline">‚è≥ Timeline:</label>
                    <input type="range" id="radar-slider" min="0" max="29" value="29">
                    <span id="radar-date">Today</span>

                    <label class="label-trails">
                        <input type="checkbox" id="radar-trails"> üå† Scia
                    </label>
                </div>
            </div>
            <!-- RADAR CHART CONTAINER -->
            <div class="chart-container" style="position: relative; flex: 1; border:none; padding:0; background:none;">
                <button onclick="toggleFullScreen('radar-chart')" class="btn-fullscreen" title="Full Screen">‚õ∂</button>
                <div id="radar-chart" style="width:100%; height:100%; background: #0f111a;"></div>
            </div>
        </div>
    </div>

    <script src="tickers.js?v=4"></script>
    <script src="app.js?v=4"></script>
</body>

</html>